<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gnomy Survey for Gig-Economy Platforms</title>
    <style>
        /* Styles as in your original file */
    </style>
</head>
<body>

<h1>Gnomy Survey for Gig-Economy Platforms</h1>

<!-- Text inputs for company info -->
<form id="surveyForm">
    <div class="question">
        <label for="companyName">Company Name</label>
        <input type="text" id="companyName" name="companyName" required>
    </div>
    <div class="question">
        <label for="contactName">Contact Person Name</label>
        <input type="text" id="contactName" name="contactName" required>
    </div>
    <div class="question">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" required>
    </div>

    <!-- 20 Questions dynamically inserted by JavaScript -->
</form>

<div class="result" id="result" style="display:none;">
    <h2>Survey Results</h2>
    <p><strong>Company Name:</strong> <span id="companyResult"></span></p>
    <p><strong>Contact Person:</strong> <span id="contactResult"></span></p>
    <p><strong>Email:</strong> <span id="emailResult"></span></p>
    <p>Yes: <span id="yesCount"></span></p>
    <p>No: <span id="noCount"></span></p>
    <p>Maybe: <span id="maybeCount"></span></p>
</div>

<script>
    const questions = [
        /* Same list of 20 questions */
    ];

    const form = document.getElementById('surveyForm');

    // Generate form questions
    questions.forEach((question, index) => {
        const div = document.createElement('div');
        div.classList.add('question');
        div.innerHTML = `
            <label for="q${index}">${question}</label>
            <input type="radio" name="q${index}" value="Yes" required> Yes
            <input type="radio" name="q${index}" value="No" required> No
            <input type="radio" name="q${index}" value="Maybe" required> Maybe
        `;
        form.appendChild(div);
    });

    // Add submit button
    const submitButton = document.createElement('button');
    submitButton.type = "button";
    submitButton.innerText = "Submit";
    submitButton.onclick = submitSurvey;
    form.appendChild(submitButton);

    function submitSurvey() {
        const formData = new FormData(form);
        const formObj = {};

        formData.forEach((value, key) => {
            formObj[key] = value;
        });

        // Submit the form data using Fetch API
        fetch('https://script.google.com/macros/s/AKfycbw5RHbjaar8275dDrsUAQRYZAcQbqnIIjxMDFpI4tHufCJQwiv3SvHF0f6XIzQnlefO/exec', {
            method: 'POST',
            body: new URLSearchParams(formData) // Converts form data into a URL-encoded string
        })
        .then(response => response.json())
        .then(data => {
            if (data.result === "success") {
                calculateResults();
            } else {
                alert("There was an error submitting the form.");
            }
        })
        .catch(error => console.error('Error:', error));
    }

    function calculateResults() {
        // The same result display logic as before
    }
</script>

</body>
</html>
